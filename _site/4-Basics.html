<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GLM 2024 - GLM basics III</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">GLM 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./lectures.html" rel="" target="">
 <span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./homework.html" rel="" target="">
 <span class="menu-text">homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#statistical-inference" id="toc-statistical-inference" class="nav-link active" data-scroll-target="#statistical-inference">Statistical Inference</a></li>
  <li><a href="#partitioning-variation" id="toc-partitioning-variation" class="nav-link" data-scroll-target="#partitioning-variation">Partitioning variation</a></li>
  <li><a href="#partitioning-variance" id="toc-partitioning-variance" class="nav-link" data-scroll-target="#partitioning-variance">Partitioning Variance</a></li>
  <li><a href="#partitioning-variance-in-y" id="toc-partitioning-variance-in-y" class="nav-link" data-scroll-target="#partitioning-variance-in-y">Partitioning variance in Y</a></li>
  <li><a href="#large-haty-bary-r_xy-fracs_ys_xx-barx" id="toc-large-haty-bary-r_xy-fracs_ys_xx-barx" class="nav-link" data-scroll-target="#large-haty-bary-r_xy-fracs_ys_xx-barx"><span class="math display">\[\Large \hat{Y} = \bar{Y} + r_{xy} \frac{s_{y}}{s_{x}}(X-\bar{X})\]</span></a></li>
  <li><a href="#coefficient-of-determination" id="toc-coefficient-of-determination" class="nav-link" data-scroll-target="#coefficient-of-determination">Coefficient of Determination</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#computing-sum-of-squares" id="toc-computing-sum-of-squares" class="nav-link" data-scroll-target="#computing-sum-of-squares">Computing Sum of Squares</a></li>
  <li><a href="#using-r-to-check-yourself" id="toc-using-r-to-check-yourself" class="nav-link" data-scroll-target="#using-r-to-check-yourself">Using <code>R</code> To Check Yourself</a></li>
  <li><a href="#mean-square-error-mse-mswmsr" id="toc-mean-square-error-mse-mswmsr" class="nav-link" data-scroll-target="#mean-square-error-mse-mswmsr">Mean Square Error (MSE) (msw/msr)</a></li>
  <li><a href="#mse" id="toc-mse" class="nav-link" data-scroll-target="#mse">MSE</a></li>
  <li><a href="#residual-standard-error" id="toc-residual-standard-error" class="nav-link" data-scroll-target="#residual-standard-error">Residual Standard Error</a></li>
  <li><a href="#residual-standard-errordeviation" id="toc-residual-standard-errordeviation" class="nav-link" data-scroll-target="#residual-standard-errordeviation">Residual standard error/deviation</a></li>
  <li><a href="#residual-standard-errordeviation-or-standard-error-of-the-estimate" id="toc-residual-standard-errordeviation-or-standard-error-of-the-estimate" class="nav-link" data-scroll-target="#residual-standard-errordeviation-or-standard-error-of-the-estimate">Residual standard error/deviation or standard error of the estimate</a></li>
  <li><a href="#rse-vs-mse" id="toc-rse-vs-mse" class="nav-link" data-scroll-target="#rse-vs-mse">RSE vs MSE</a></li>
  <li><a href="#residual-standard-error-and-sigma" id="toc-residual-standard-error-and-sigma" class="nav-link" data-scroll-target="#residual-standard-error-and-sigma">Residual Standard Error and Sigma</a></li>
  <li><a href="#why-do-we-care-about-sigma" id="toc-why-do-we-care-about-sigma" class="nav-link" data-scroll-target="#why-do-we-care-about-sigma">Why do we care about sigma?</a></li>
  <li><a href="#r2-and-residual-standard-deviation" id="toc-r2-and-residual-standard-deviation" class="nav-link" data-scroll-target="#r2-and-residual-standard-deviation">R2 and residual standard deviation</a></li>
  <li><a href="#inferential-tests" id="toc-inferential-tests" class="nav-link" data-scroll-target="#inferential-tests">Inferential tests</a></li>
  <li><a href="#omnibus-test" id="toc-omnibus-test" class="nav-link" data-scroll-target="#omnibus-test">Omnibus test</a></li>
  <li><a href="#model-comparisons" id="toc-model-comparisons" class="nav-link" data-scroll-target="#model-comparisons">Model Comparisons</a></li>
  <li><a href="#full-vs.-restricted-models" id="toc-full-vs.-restricted-models" class="nav-link" data-scroll-target="#full-vs.-restricted-models">Full vs.&nbsp;Restricted Models</a></li>
  <li><a href="#the-comparison" id="toc-the-comparison" class="nav-link" data-scroll-target="#the-comparison">The comparison!</a></li>
  <li><a href="#model-comparisons-1" id="toc-model-comparisons-1" class="nav-link" data-scroll-target="#model-comparisons-1">Model Comparisons</a></li>
  <li><a href="#regression-coefficient" id="toc-regression-coefficient" class="nav-link" data-scroll-target="#regression-coefficient">Regression coefficient</a></li>
  <li><a href="#what-does-the-regression-coefficient-test" id="toc-what-does-the-regression-coefficient-test" class="nav-link" data-scroll-target="#what-does-the-regression-coefficient-test">What does the regression coefficient test?</a></li>
  <li><a href="#regression-coefficient-1" id="toc-regression-coefficient-1" class="nav-link" data-scroll-target="#regression-coefficient-1">Regression coefficient</a></li>
  <li><a href="#se_b" id="toc-se_b" class="nav-link" data-scroll-target="#se_b">SE_b</a></li>
  <li><a href="#intercept" id="toc-intercept" class="nav-link" data-scroll-target="#intercept">Intercept</a></li>
  <li><a href="#confidence-interval-for-coefficents" id="toc-confidence-interval-for-coefficents" class="nav-link" data-scroll-target="#confidence-interval-for-coefficents">Confidence interval for coefficents</a></li>
  <li><a href="#confidence-bands-for-regression-line" id="toc-confidence-bands-for-regression-line" class="nav-link" data-scroll-target="#confidence-bands-for-regression-line">Confidence bands for regression line</a></li>
  <li><a href="#confidence-bands" id="toc-confidence-bands" class="nav-link" data-scroll-target="#confidence-bands">Confidence Bands</a></li>
  <li><a href="#prediction-band" id="toc-prediction-band" class="nav-link" data-scroll-target="#prediction-band">Prediction band</a></li>
  <li><a href="#regression-equation" id="toc-regression-equation" class="nav-link" data-scroll-target="#regression-equation">Regression equation</a></li>
  <li><a href="#interpretting-multiple-regression-model" id="toc-interpretting-multiple-regression-model" class="nav-link" data-scroll-target="#interpretting-multiple-regression-model">Interpretting multiple regression model</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example</a></li>
  <li><a href="#visualizing-multiple-regression" id="toc-visualizing-multiple-regression" class="nav-link" data-scroll-target="#visualizing-multiple-regression">Visualizing multiple regression</a></li>
  <li><a href="#calculating-coefficients" id="toc-calculating-coefficients" class="nav-link" data-scroll-target="#calculating-coefficients">Calculating coefficients</a></li>
  <li><a href="#calculating-the-standardized-partial-regression-coefficient" id="toc-calculating-the-standardized-partial-regression-coefficient" class="nav-link" data-scroll-target="#calculating-the-standardized-partial-regression-coefficient">Calculating the standardized partial regression coefficient</a></li>
  <li><a href="#original-metric" id="toc-original-metric" class="nav-link" data-scroll-target="#original-metric">Original Metric</a></li>
  <li><a href="#controlling-for" id="toc-controlling-for" class="nav-link" data-scroll-target="#controlling-for">“Controlling for”</a></li>
  <li><a href="#estimating-model-fit" id="toc-estimating-model-fit" class="nav-link" data-scroll-target="#estimating-model-fit">Estimating model fit</a></li>
  <li><a href="#multiple-correlation-r" id="toc-multiple-correlation-r" class="nav-link" data-scroll-target="#multiple-correlation-r">Multiple correlation, R</a></li>
  <li><a href="#significance-tests" id="toc-significance-tests" class="nav-link" data-scroll-target="#significance-tests">significance tests</a></li>
  <li><a href="#r-squared-r2" id="toc-r-squared-r2" class="nav-link" data-scroll-target="#r-squared-r2">R-squared, <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#adjusted-r-squared-textadj-r2" id="toc-adjusted-r-squared-textadj-r2" class="nav-link" data-scroll-target="#adjusted-r-squared-textadj-r2">Adjusted R-squared, <span class="math inline">\(\text{Adj} R^2\)</span></a></li>
  <li><a href="#adjusted-r-squared-textadj-r2-1" id="toc-adjusted-r-squared-textadj-r2-1" class="nav-link" data-scroll-target="#adjusted-r-squared-textadj-r2-1">Adjusted R-squared, <span class="math inline">\(\text{Adj} R^2\)</span></a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li><a href="#anova-1" id="toc-anova-1" class="nav-link" data-scroll-target="#anova-1">ANOVA</a></li>
  <li><a href="#test-of-individual-regression-coefficients" id="toc-test-of-individual-regression-coefficients" class="nav-link" data-scroll-target="#test-of-individual-regression-coefficients">Test of individual regression coefficients</a></li>
  <li><a href="#test-of-individual-regression-coefficients-1" id="toc-test-of-individual-regression-coefficients-1" class="nav-link" data-scroll-target="#test-of-individual-regression-coefficients-1">Test of individual regression coefficients</a></li>
  <li><a href="#can-you" id="toc-can-you" class="nav-link" data-scroll-target="#can-you">Can you…</a></li>
  <li><a href="#warm-up" id="toc-warm-up" class="nav-link" data-scroll-target="#warm-up">Warm Up</a></li>
  <li><a href="#which-variables-to-include" id="toc-which-variables-to-include" class="nav-link" data-scroll-target="#which-variables-to-include">Which variables to include</a></li>
  <li><a href="#hierarchical-regression-model-comparison" id="toc-hierarchical-regression-model-comparison" class="nav-link" data-scroll-target="#hierarchical-regression-model-comparison">Hierarchical regression / Model Comparison</a></li>
  <li><a href="#r-square-change" id="toc-r-square-change" class="nav-link" data-scroll-target="#r-square-change">R-square change</a></li>
  <li><a href="#model-comparisons-2" id="toc-model-comparisons-2" class="nav-link" data-scroll-target="#model-comparisons-2">Model comparisons</a></li>
  <li><a href="#model-comparisons-3" id="toc-model-comparisons-3" class="nav-link" data-scroll-target="#model-comparisons-3">model comparisons</a></li>
  <li><a href="#model-comparisons-4" id="toc-model-comparisons-4" class="nav-link" data-scroll-target="#model-comparisons-4">model comparisons</a></li>
  <li><a href="#model-comparisons-5" id="toc-model-comparisons-5" class="nav-link" data-scroll-target="#model-comparisons-5">model comparisons</a></li>
  <li><a href="#model-comparisons-6" id="toc-model-comparisons-6" class="nav-link" data-scroll-target="#model-comparisons-6">model comparisons</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="4-Basics.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GLM basics III</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="statistical-inference" class="level2">
<h2 class="anchored" data-anchor-id="statistical-inference">Statistical Inference</h2>
<ul>
<li><p>The way the world is = our model + error</p></li>
<li><p>How good is our model? Does it “fit” the data well?</p></li>
<li><p>To assess how well our model fits the data, we simply take all the variability in our outcome and partition it into different categories. For now, we will partition it into two categories: the variability that is predicted by (explained by) our model, and variability that is not.</p></li>
</ul>
</section>
<section id="partitioning-variation" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-variation">Partitioning variation</h2>
<ul>
<li><p>We formally test how well we are doing with our guesses by partitioning variation</p></li>
<li><p>To the extent that we can generate different predicted values of Y, based on the values of the predicors, we are doing well in our prediction</p></li>
</ul>
<p><span class="math display">\[\sum (Y - \bar{Y})^2 = \sum (\hat{Y} -\bar{Y})^2 + \sum(Y - \hat{Y})^2\]</span></p>
<p>Each of these is the sum of a squared deviation from an expected value of Y. We can abbreviate the sum of squared deviations:</p>
<p><span class="math display">\[SS_{Y} = SS_{\text{Model}} + SS_{\text{Residual}}\]</span></p>
<p><span class="math display">\[\frac{s^2_{regression}}{s^2_y} = \frac{SS_{regression}}{SS_Y} = R^2\]</span></p>
</section>
<section id="partitioning-variance" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-variance">Partitioning Variance</h2>
<p>The relative magnitude of sums of squares, especially in more complex designs, provides a way of identifying particularly large and important sources of variability. In the future, we can further partition <span class="math inline">\(SS_{\text{Model}}\)</span> and <span class="math inline">\(SS_{\text{Residual}}\)</span> into smaller pieces, which will help us make more specific inferences and increase statistical power, respectively.</p>
<p><span class="math display">\[\Large s^2_Y = s^2_{\hat{Y}} + s^2_{e}\]</span></p>
</section>
<section id="partitioning-variance-in-y" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-variance-in-y">Partitioning variance in Y</h2>
<p>Consider the case with no correlation between X and Y</p>
</section>
<section id="large-haty-bary-r_xy-fracs_ys_xx-barx" class="level2">
<h2 class="anchored" data-anchor-id="large-haty-bary-r_xy-fracs_ys_xx-barx"><span class="math display">\[\Large \hat{Y} = \bar{Y} + r_{xy} \frac{s_{y}}{s_{x}}(X-\bar{X})\]</span></h2>
<p><span class="math display">\[\Large \hat{Y} = \bar{Y}\]</span></p>
<p>To the extent that we can generate different predicted values of Y based on the values of the predictors, we are doing well in our prediction</p>
<p><span class="math display">\[\large \sum (Y - \bar{Y})^2 = \sum (\hat{Y} -\bar{Y})^2 + \sum(Y - \hat{Y})^2\]</span></p>
</section>
<section id="coefficient-of-determination" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-of-determination">Coefficient of Determination</h2>
<p><span class="math display">\[\Large \frac{s_{Model}^2}{s_{y}^2} = \frac{SS_{Model}}{SS_{Y}} = R^2\]</span></p>
<p><span class="math inline">\(R^2\)</span> represents the proportion of variance in Y that is explained by the model.</p>
<p><span class="math inline">\(\sqrt{R^2} = R\)</span> is the correlation between the predicted values of Y from the model and the actual values of Y</p>
<p><span class="math display">\[\large \sqrt{R^2} = r_{Y\hat{Y}}\]</span></p>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>e<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> x<span class="fl">.1</span> <span class="sc">+</span> e<span class="fl">.1</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.1</span>,y<span class="fl">.1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.1</span>, <span class="at">data =</span> d<span class="fl">.1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>d1.f<span class="ot">&lt;-</span> <span class="fu">augment</span>(m<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d1.f <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x<span class="fl">.1</span>, <span class="at">y =</span> y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F, <span class="at">method =</span> <span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> .fitted), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">35</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d1.f <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y<span class="fl">.1</span>, <span class="at">y =</span> .fitted)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> F, <span class="at">method =</span> <span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>galton.data <span class="ot">&lt;-</span> psychTools<span class="sc">::</span>galton</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">lm</span>(child <span class="sc">~</span> parent, <span class="at">data =</span> galton.data)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = child ~ parent, data = galton.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.8050 -1.3661  0.0487  1.6339  5.9264 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 23.94153    2.81088   8.517   &lt;2e-16 ***
parent       0.64629    0.04114  15.711   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.239 on 926 degrees of freedom
Multiple R-squared:  0.2105,    Adjusted R-squared:  0.2096 
F-statistic: 246.8 on 1 and 926 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.1</span>)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2104629</code></pre>
</div>
</div>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(galton.data<span class="sc">$</span>parent, galton.data<span class="sc">$</span>child, <span class="at">use =</span> <span class="st">"pairwise"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4587624</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(galton.data<span class="sc">$</span>parent, galton.data<span class="sc">$</span>child)<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2104629</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>galton.fits <span class="ot">=</span> <span class="fu">augment</span>(fit<span class="fl">.1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(galton.fits<span class="sc">$</span>child, galton.fits<span class="sc">$</span>.fitted)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4587624</code></pre>
</div>
</div>
</section>
<section id="computing-sum-of-squares" class="level2">
<h2 class="anchored" data-anchor-id="computing-sum-of-squares">Computing Sum of Squares</h2>
<p><span class="math display">\[\Large \frac{SS_{Model}}{SS_{Y}} = R^2\]</span> <span class="math display">\[\Large SS_{Model} = R^2({SS_{Y})}\]</span></p>
<p><span class="math display">\[\Large SS_{Y} = SS_{Model} + SS_{residual}\]</span></p>
<p><span class="math display">\[\Large SS_{residual} = SS_{Y} - R^2({SS_{Y})}\]</span></p>
<p><span class="math display">\[\Large  SS_{residual} = (1- R^2){SS_{Y}}\]</span></p>
</section>
<section id="using-r-to-check-yourself" class="level2">
<h2 class="anchored" data-anchor-id="using-r-to-check-yourself">Using <code>R</code> To Check Yourself</h2>
<p><span class="math display">\[SS_{residual} = (1- R^2){SS_{Y}}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">=</span> <span class="fu">summary</span>(fit<span class="fl">.1</span>)<span class="sc">$</span>r.squared</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>anova <span class="ot">=</span> <span class="fu">summary</span>(<span class="fu">aov</span>(fit<span class="fl">.1</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>ssTotal <span class="ot">=</span> fit.<span class="fl">1.</span>anova[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>] <span class="sc">+</span> fit.<span class="fl">1.</span>anova[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span>]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>ssResidual <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> r2) <span class="sc">*</span> ssTotal</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># print things out</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>fit.<span class="fl">1.</span>anova</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)    
parent        1   1237    1237   246.8 &lt;2e-16 ***
Residuals   926   4640       5                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ssResidual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4640.273</code></pre>
</div>
</div>
<p>???</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mean-square-error-mse-mswmsr" class="level2">
<h2 class="anchored" data-anchor-id="mean-square-error-mse-mswmsr">Mean Square Error (MSE) (msw/msr)</h2>
<ul>
<li>AKA square of residual standard error/deviation (sigma)</li>
<li><em>Unbiased</em> estimate of error variance</li>
<li>Measure of discrepancy between the data and the model</li>
<li>The MSE is the variance of data around the fitted regression line</li>
<li>Just like with MSwithin, which was variance around predicted group means</li>
<li>It is the mean of the square of the residuals</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fit<span class="fl">.1</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6 
-7.805016 -6.512435 -4.573563 -3.927273 -3.604127 -5.366144 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(fit<span class="fl">.1</span><span class="sc">$</span>residuals <span class="sc">^</span> <span class="dv">2</span>), <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
</section>
<section id="mse" class="level2">
<h2 class="anchored" data-anchor-id="mse">MSE</h2>
<ul>
<li>It is the square of the residual standard error/deviation (sigma) aka <span class="math inline">\(RSE^2\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">=</span> <span class="fu">round</span>((<span class="fu">summary</span>(fit<span class="fl">.1</span>)[[<span class="st">"sigma"</span>]]) <span class="sc">^</span><span class="dv">2</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.01</code></pre>
</div>
</div>
</section>
<section id="residual-standard-error" class="level2">
<h2 class="anchored" data-anchor-id="residual-standard-error">Residual Standard Error</h2>
<div class="cell" data-highlight.output="16">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = child ~ parent, data = galton.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.8050 -1.3661  0.0487  1.6339  5.9264 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 23.94153    2.81088   8.517   &lt;2e-16 ***
parent       0.64629    0.04114  15.711   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.239 on 926 degrees of freedom
Multiple R-squared:  0.2105,    Adjusted R-squared:  0.2096 
F-statistic: 246.8 on 1 and 926 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="residual-standard-errordeviation" class="level2">
<h2 class="anchored" data-anchor-id="residual-standard-errordeviation">Residual standard error/deviation</h2>
<ul>
<li>aka standard deviation of the residual</li>
<li>aka <strong>standard error of the estimate</strong></li>
</ul>
<p><span class="math display">\[\hat{\sigma} = \sqrt{\frac{SS_{\text{Residual}}}{df_{\text{Residual}}}} = s_{Y|X} = \sqrt{\frac{\Sigma(Y_i -\hat{Y_i})^2}{N-2}}\]</span></p>
<ul>
<li><p>interpreted in original units (unlike <span class="math inline">\(R^2\)</span>)</p></li>
<li><p>standard deviation of Y not accounted by model</p></li>
</ul>
</section>
<section id="residual-standard-errordeviation-or-standard-error-of-the-estimate" class="level2">
<h2 class="anchored" data-anchor-id="residual-standard-errordeviation-or-standard-error-of-the-estimate">Residual standard error/deviation or standard error of the estimate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.1</span>)<span class="sc">$</span>sigma </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.238547</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>galton.data<span class="fl">.1</span> <span class="ot">=</span> broom<span class="sc">::</span><span class="fu">augment</span>(fit<span class="fl">.1</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(galton.data<span class="fl">.1</span><span class="sc">$</span>.resid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n mean   sd median trimmed  mad   min  max range  skew kurtosis   se
X1    1 928    0 2.24   0.05    0.06 2.26 -7.81 5.93 13.73 -0.24    -0.23 0.07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(galton.data<span class="sc">$</span>child)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.517941</code></pre>
</div>
</div>
<p>Because the size of <span class="math inline">\(\hat{\sigma}\)</span> depends on both how well the model does as well as the original units of measurement, it is important to compare it to Y to evaluate!</p>
</section>
<section id="rse-vs-mse" class="level2">
<h2 class="anchored" data-anchor-id="rse-vs-mse">RSE vs MSE</h2>
<p>Residual standard error = square root of the mean square error</p>
<p>Both measuring error, but RSE is a little more useful</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(mse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.238303</code></pre>
</div>
</div>
</section>
<section id="residual-standard-error-and-sigma" class="level2">
<h2 class="anchored" data-anchor-id="residual-standard-error-and-sigma">Residual Standard Error and Sigma</h2>
<ul>
<li>So many names to represent the spread of data around the regression line</li>
<li>Standard deviation of the residual, standard error of the estimate, MSE…</li>
<li>We will refer to this as sigma, and use estimated sigma, as we do not know the population value ( <span class="math inline">\(\hat{\sigma}\)</span> )</li>
<li>It is interpreted in original units (unlike <span class="math inline">\(R^2\)</span> )</li>
<li>It is the standard deviation of Y not accounted by the model (i.e., residuals)</li>
</ul>
</section>
<section id="why-do-we-care-about-sigma" class="level2">
<h2 class="anchored" data-anchor-id="why-do-we-care-about-sigma">Why do we care about sigma?</h2>
<ul>
<li>Let’s simulate!</li>
<li>Data generating process:</li>
</ul>
<p><span class="math display">\[Y_{i} \sim\mathcal{N}(\mu,\,\sigma)\ \]</span></p>
<ul>
<li><p>In English: our DV for individual <span class="math inline">\(i\)</span> is distributed normally with a mean of <span class="math inline">\(\mu\)</span> and a standard deviation of <span class="math inline">\(\sigma\)</span></p></li>
<li><p>This describes how we think our DVs are generated, and the paramters of interest A a standard regression model assumes this, but we will see other DGPs such as binomial or poisson that do not</p></li>
<li><p>For normal, <span class="math inline">\(\mu\)</span> gets all the focus but <span class="math inline">\(\sigma\)</span> is just as important</p></li>
</ul>
<hr>
<p>Our plan is to fix <span class="math inline">\(\mu\)</span> and then vary sigma to see what happens</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># randomly select 1000 numbers for x</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>e<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># randomly select 1000 numbers for error</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> x<span class="fl">.1</span> <span class="sc">+</span> e<span class="fl">.1</span> <span class="co"># create our y</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.1</span>,y<span class="fl">.1</span>) <span class="co"># combine x and y into a data.frame</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.1</span>, <span class="at">data =</span> d<span class="fl">.1</span>) <span class="co"># use x to predict y with this data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y.1 ~ x.1, data = d.1)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1661 -0.6439  0.0145  0.6537  3.0684 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.51599    0.03100   16.64   &lt;2e-16 ***
x.1          0.60571    0.03109   19.48   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9801 on 998 degrees of freedom
Multiple R-squared:  0.2755,    Adjusted R-squared:  0.2748 
F-statistic: 379.5 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> x<span class="fl">.1</span>,<span class="at">y =</span>  y<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>    </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))  <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<p>Again, but with a larger sigma</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">987</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>e<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">2</span>) <span class="co"># larger sigma</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>y<span class="fl">.2</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> x<span class="fl">.1</span> <span class="sc">+</span> e<span class="fl">.2</span> <span class="co"># same Xs, same mu (.5)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>d<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.1</span>,y<span class="fl">.2</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.2</span> <span class="sc">~</span> x<span class="fl">.1</span>, <span class="at">data =</span> d<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y.2 ~ x.1, data = d.2)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.6267 -1.4359 -0.0192  1.4480  6.3439 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.52137    0.06345   8.217 6.43e-16 ***
x.1          0.59823    0.06363   9.402  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.006 on 998 degrees of freedom
Multiple R-squared:  0.08136,   Adjusted R-squared:  0.08044 
F-statistic: 88.39 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x=</span>x<span class="fl">.1</span>, <span class="at">y=</span>y<span class="fl">.2</span>)) <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>    </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))  <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="r2-and-residual-standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="r2-and-residual-standard-deviation">R2 and residual standard deviation</h2>
<ul>
<li><p>two sides of same coin</p></li>
<li><p>one in original units, the other standardized</p></li>
<li><p><span class="math inline">\(R^2\)</span> can be tricky because the numerator and denominator can be changed in different ways.</p></li>
<li><p>for example if variance in Y is changed but with the same regression model and residual standard error, <span class="math inline">\(R^2\)</span> could increase or decrease</p></li>
</ul>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20200116</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">4</span>, .<span class="dv">01</span>, <span class="at">by =</span> <span class="sc">-</span>.<span class="dv">1</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">=</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(e))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>rsd<span class="ot">=</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(e))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(e)){</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  e<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, e[i])</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  y<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> x<span class="fl">.1</span> <span class="sc">+</span> e<span class="fl">.1</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  d<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x<span class="fl">.1</span>,y<span class="fl">.1</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  m<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="fl">.1</span> <span class="sc">~</span> x<span class="fl">.1</span>, <span class="at">data =</span> d<span class="fl">.1</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  r2[i] <span class="ot">=</span> <span class="fu">summary</span>(m<span class="fl">.1</span>)<span class="sc">$</span>r.squared</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  rsd[i] <span class="ot">=</span> <span class="fu">summary</span>(m<span class="fl">.1</span>)<span class="sc">$</span>sigma</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">r2 =</span> r2, <span class="at">rsd =</span> rsd) <span class="sc">%&gt;%</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> r2, <span class="at">y =</span> rsd)) <span class="sc">+</span> </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(R<span class="sc">^</span><span class="dv">2</span>))) <span class="sc">+</span> </span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(sigma[e])))  <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="inferential-tests" class="level2">
<h2 class="anchored" data-anchor-id="inferential-tests">Inferential tests</h2>
<p>NHST is about making decisions:</p>
<ul>
<li>these two means are/are not different</li>
<li>this correlation is/is not significantly different from 0</li>
<li>the distribution of this categorical variable is/is not different between these groups</li>
</ul>
<p>In regression, there are several inferential tests being conducted at once. The first is called the <strong>omnibus test</strong> – this is a test of whether the model fits the data.</p>
</section>
<section id="omnibus-test" class="level2">
<h2 class="anchored" data-anchor-id="omnibus-test">Omnibus test</h2>
<p><span class="math display">\[\Large H_{0}: \rho_{XY}^2= 0\]</span></p>
<p><span class="math display">\[\Large H_{0}: \rho_{XY}^2 \neq 0\]</span></p>
<p>It is possible to calculate the significance of your regression with a correlation test. In fact, it would seem quite practical and logical to do so.</p>
<hr>
<p>However, historically we use a different probability distribution – <strong>the <em>F</em> distribution</strong> to estimate the significance of our model. It’s important to know that these methods are mathematically equivalent. But the <em>F</em> distribution is useful here, because it works with our ability to partition variance.</p>
</section>
<section id="model-comparisons" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons">Model Comparisons</h2>
<ul>
<li>So the omnibus <span class="math inline">\(F\)</span>-statistic is the ratio of MSregression to MSresidual</li>
<li>Test of overall significance. Does your model give a better fit to the data than a model that contains no independent variables?</li>
<li>This is truly a question of model comparisons!</li>
</ul>
<hr>
<ul>
<li><p>The basic idea is asking how much variance remains unexplained in our model. This “left over” variance can be contrasted with an alternative model/hypothesis. Does adding a new predictor variable help explain more variance or should we stick with the most parsimonious (simplest) model?</p></li>
<li><p>Every model you report implies that you are favoring that model over an alternative model, typically the null. Taking a more formal model comparison approach allows you to be more flexible, explicit, and deliberate.</p></li>
</ul>
</section>
<section id="full-vs.-restricted-models" class="level2">
<h2 class="anchored" data-anchor-id="full-vs.-restricted-models">Full vs.&nbsp;Restricted Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(child <span class="sc">~</span> parent, <span class="at">data =</span> galton.data)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(child <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> galton.data)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = child ~ 1, data = galton.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3885 -1.8885  0.1115  2.1115  5.6115 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 68.08847    0.08266   823.8   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.518 on 927 degrees of freedom</code></pre>
</div>
</div>
<hr>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = child ~ parent, data = galton.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-7.8050 -1.3661  0.0487  1.6339  5.9264 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 23.94153    2.81088   8.517   &lt;2e-16 ***
parent       0.64629    0.04114  15.711   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.239 on 926 degrees of freedom
Multiple R-squared:  0.2105,    Adjusted R-squared:  0.2096 
F-statistic: 246.8 on 1 and 926 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: child
           Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 927 5877.2    6.34               </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: child
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
parent      1 1236.9 1236.93  246.84 &lt; 2.2e-16 ***
Residuals 926 4640.3    5.01                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="the-comparison" class="level2">
<h2 class="anchored" data-anchor-id="the-comparison">The comparison!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit<span class="fl">.1</span>, fit<span class="fl">.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: child ~ parent
Model 2: child ~ 1
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    926 4640.3                                  
2    927 5877.2 -1   -1236.9 246.84 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-comparisons-1" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-1">Model Comparisons</h2>
<ul>
<li>Model comparisons are redundant with nil/null hypotheses and coefficient tests right now, be they’ll be more flexible down the road</li>
<li>Key is to start thinking about your implicit alternative models</li>
<li>The ultimate goal would be to create two models that represent two equally plausible theories</li>
<li>Theory A is made up of components XYZ, whereas theory B has QRS components. You can then ask which theory (model) is better.</li>
<li>A model embodies your hypothesis! It is the mathematical expression of your hypothesis!</li>
</ul>
</section>
<section id="regression-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="regression-coefficient">Regression coefficient</h2>
<p><span class="math display">\[\Large H_{0}: \beta_{1}= 0\]</span> <span class="math display">\[\Large H_{1}: \beta_{1} \neq 0\]</span></p>
</section>
<section id="what-does-the-regression-coefficient-test" class="level2">
<h2 class="anchored" data-anchor-id="what-does-the-regression-coefficient-test">What does the regression coefficient test?</h2>
<ul>
<li><p>Does X provide any predictive information?</p></li>
<li><p>Does X provide any explanatory power regarding the variability of Y?</p></li>
<li><p>Is the the average value the best guess (i.e., is Y bar equal to the predicted value of Y?)</p></li>
<li><p>Is the regression line flat?</p></li>
<li><p>Are X and Y correlated?</p></li>
</ul>
</section>
<section id="regression-coefficient-1" class="level2">
<h2 class="anchored" data-anchor-id="regression-coefficient-1">Regression coefficient</h2>
<p><span class="math display">\[\Large se_{b} = \frac{s_{Y}}{s_{X}}{\sqrt{\frac {1-r_{xy}^2}{n-2}}}\]</span> <span class="math display">\[\Large t(n-2) = \frac{b_{1}}{se_{b}}\]</span></p>
</section>
<section id="se_b" class="level2">
<h2 class="anchored" data-anchor-id="se_b">SE_b</h2>
<ul>
<li><p>standard errors for the slope coefficient</p></li>
<li><p>represent our uncertainty (noise) in our estimate of the regression coefficient</p></li>
<li><p>different from residual standard error/deviation (but proportional to)</p></li>
<li><p>much like previously we can take our estimate (b) and put confidence regions around it to get an estimate of what could be “possible” if we ran the study again</p></li>
</ul>
</section>
<section id="intercept" class="level2">
<h2 class="anchored" data-anchor-id="intercept">Intercept</h2>
<ul>
<li><p>more complex standard error calculation as the calculation depends on how far the X value (here zero) is away from the mean of X</p>
<ul>
<li>farther from the mean, less information, thus more uncertainty</li>
</ul></li>
</ul>
</section>
<section id="confidence-interval-for-coefficents" class="level2">
<h2 class="anchored" data-anchor-id="confidence-interval-for-coefficents">Confidence interval for coefficents</h2>
<ul>
<li>Same equation as we’ve been working with</li>
<li>Estimate plus minus 1.96*se</li>
</ul>
</section>
<section id="confidence-bands-for-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="confidence-bands-for-regression-line">Confidence bands for regression line</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>px<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>pe<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>py<span class="fl">.1</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> px<span class="fl">.1</span> <span class="sc">+</span> pe<span class="fl">.1</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>pd<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(px<span class="fl">.1</span>,py<span class="fl">.1</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>px<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>pe<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>py<span class="fl">.2</span> <span class="ot">&lt;-</span> .<span class="dv">5</span> <span class="sc">+</span> .<span class="dv">55</span> <span class="sc">*</span> px<span class="fl">.2</span> <span class="sc">+</span> pe<span class="fl">.2</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>pd<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(px<span class="fl">.2</span>,py<span class="fl">.2</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pd<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> px<span class="fl">.1</span>,<span class="at">y =</span>  py<span class="fl">.1</span>)) <span class="sc">+</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>    </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm) <span class="sc">+</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))  <span class="sc">+</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pd<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x=</span>px<span class="fl">.2</span>, <span class="at">y=</span>py<span class="fl">.2</span>)) <span class="sc">+</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span>    </span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))  <span class="sc">+</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cowplot'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lubridate':

    stamp</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(p1, p2, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"N = 1000"</span>, <span class="st">"N = 100"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 19 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 19 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="confidence-bands" class="level2">
<h2 class="anchored" data-anchor-id="confidence-bands">Confidence Bands</h2>
<p><span class="math display">\[\hat{Y}\pm t_{critical} * se_{residual}*\sqrt{\frac {1}{n}+\frac{(X-\bar{X})^2}{(n-1)s_{X}^2}}\]</span></p>
</section>
<section id="prediction-band" class="level2">
<h2 class="anchored" data-anchor-id="prediction-band">Prediction band</h2>
<ul>
<li>We are predicting and individual <em>i</em>’s score, not the <span class="math inline">\(\hat{Y}\)</span> for a particular level of <span class="math inline">\(X\)</span>. (A new <span class="math inline">\(Y_i\)</span> given <span class="math inline">\(X\)</span>, rather than <span class="math inline">\(\bar{Y}\)</span> given <span class="math inline">\(X\)</span> )</li>
<li>Because there is greater variation in predicting an individual value rather than a collection of individual values (i.e., the mean) the prediction band is greater</li>
<li>Combines unknown variability in 1) the estimated mean (as reflected in se of b) 2) peoples scores around mean (residual standard error)</li>
</ul>
<p><span class="math display">\[\hat{Y}\pm t_{critical} * se_{residual}*\sqrt{1+ \frac {1}{n}+\frac{(X-\bar{X})^2}{(n-1)s_{X}^2}}\]</span></p>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>temp_var <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit<span class="fl">.1</span>, <span class="at">interval=</span><span class="st">"prediction"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(galton.data, temp_var)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(new_df, <span class="fu">aes</span>(<span class="at">y=</span>child, <span class="at">x=</span>parent))<span class="sc">+</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>() <span class="sc">+</span>   </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm,<span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr), </span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">alpha =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
<ul>
<li>Can you get an individual’s predicted score &amp; residual from an equation?</li>
<li>Can you calculate b0 &amp; b1?</li>
<li>Can you take the output from <code>R</code> and write a regression equation?</li>
<li>Can you tell me if you have a “good” model?</li>
<li>Is a coefficient meaningful? How do you know and can you calculate it?</li>
<li>Can you plot a regression, confidence band, and prediction band?</li>
</ul>
</section>
<section id="regression-equation" class="level2">
<h2 class="anchored" data-anchor-id="regression-equation">Regression equation</h2>
<p><span class="math display">\[\large \hat{Y} = b_0 + b_1X_1 + b_2X_2 + \dots+b_kX_k\]</span></p>
<ul>
<li><p>regression coefficients are “partial” regression coefficients</p>
<ul>
<li><p>predicted change in <span class="math inline">\(Y\)</span> for a 1 unit change in <span class="math inline">\(X\)</span>, <em>holding all other predictors constant</em></p></li>
<li><p>similar to semi-partial correlation – represents part of each <span class="math inline">\(X\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="interpretting-multiple-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="interpretting-multiple-regression-model">Interpretting multiple regression model</h2>
<p><span class="math display">\[\large \hat{Y} = b_0 + b_1X_1 + b_2X_2 + \dots+b_kX_k\]</span></p>
<ul>
<li>Intercept is the value of <span class="math inline">\(Y\)</span> when all predictors = 0</li>
<li>Regression coefficients are the predicted change in <span class="math inline">\(Y\)</span> for a 1 unit change in <span class="math inline">\(X\)</span>, <em>holding all other predictors constant</em></li>
</ul>
<hr>
<ul>
<li><p>Residual in simple regression can be thought of as a measure of <span class="math inline">\(Y\)</span> that is left over after accounting for your DV</p></li>
<li><p>Partial correlation can be created by:</p>
<ol type="1">
<li>create a measure of <span class="math inline">\(X_1\)</span> that is independent of <span class="math inline">\(X_2\)</span></li>
<li>create a measure of <span class="math inline">\(Y\)</span> that is independent of <span class="math inline">\(X_2\)</span></li>
<li>correlate the new measures</li>
</ol></li>
</ul>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>stress.data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"stress.csv"</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(stress.data<span class="sc">$</span>Stress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n mean   sd median trimmed  mad  min   max range skew kurtosis   se
X1    1 118 5.18 1.88   5.27    5.17 1.65 0.62 10.32  9.71 0.08     0.22 0.17</code></pre>
</div>
</div>
</section>
<section id="example-3" class="level2">
<h2 class="anchored" data-anchor-id="example-3">Example</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>mr.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   -0.316    0.856     -0.369 7.13e- 1
2 Support        0.406    0.0512     7.94  1.49e-12
3 Anxiety        0.256    0.0674     3.80  2.34e- 4</code></pre>
</div>
</div>
<p>???</p>
<p>If a univariate regression is estimating the best-fit line, what is this estimating?</p>
</section>
<section id="visualizing-multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-multiple-regression">Visualizing multiple regression</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg2d</span>(mr.model,<span class="st">"Support"</span>, <span class="st">"Anxiety"</span>, <span class="at">plot.type =</span> <span class="st">"persp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="calculating-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="calculating-coefficients">Calculating coefficients</h2>
<p>Just like with univariate regression, we calculate the OLS solution. As a reminder, this calculation will yield the estimate that reduces the sum of the squared deviations from the line:</p>
<p><span class="math display">\[\large \hat{Y} = b_0 + b_{1}X1 + b_{2}X_2\]</span> <span class="math display">\[\large \text{minimize} \sum (Y-\hat{Y})^2 \]</span></p>
</section>
<section id="calculating-the-standardized-partial-regression-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-standardized-partial-regression-coefficient">Calculating the standardized partial regression coefficient</h2>
<p><span class="math display">\[b_{1}^* = \frac{r_{Y1}-r_{Y2}r_{12}}{1-r_{12}^2}\]</span></p>
<p><span class="math display">\[b_{2}^* = \frac{r_{Y2}-r_{Y1}r_{12}}{1-r_{12}^2}\]</span></p>
</section>
<section id="original-metric" class="level2">
<h2 class="anchored" data-anchor-id="original-metric">Original Metric</h2>
<p><span class="math display">\[b_{1} = b_{1}^*\frac{s_{Y}}{s_{X1}}\]</span></p>
<p><span class="math display">\[b_{1}^* = b_{1}\frac{s_{X1}}{s_{Y}}\]</span></p>
<p><span class="math display">\[b_{0} = \bar{Y} - b_{1}\bar{X_{1}} - b_{2}\bar{X_{2}}\]</span></p>
<hr>
<div class="cell" data-highlight.output="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>mr.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support + Anxiety, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1958 -0.8994 -0.1370  0.9990  3.6995 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11</code></pre>
</div>
</div>
<hr>
<div class="cell" data-highlight.output="[12,13]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>mr.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support + Anxiety, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1958 -0.8994 -0.1370  0.9990  3.6995 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11</code></pre>
</div>
</div>
</section>
<section id="controlling-for" class="level2">
<h2 class="anchored" data-anchor-id="controlling-for">“Controlling for”</h2>
<p><img src="control.gif" class="img-fluid"></p>
<p>Taken from <a href="https://twitter.com/nickchk/status/1068215492458905600"><span class="citation" data-cites="nickchk">@nickchk</span></a></p>
<hr>
</section>
<section id="estimating-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="estimating-model-fit">Estimating model fit</h2>
<div class="cell" data-highlight.output="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>mr.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support + Anxiety, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1958 -0.8994 -0.1370  0.9990  3.6995 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11</code></pre>
</div>
</div>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>stress.data1 <span class="ot">=</span> <span class="fu">augment</span>(mr.model)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>stress.data1 <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Stress, <span class="at">y =</span> .fitted)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="st">"Y (Stress)"</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(Y))) <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="4-Basics_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="multiple-correlation-r" class="level2">
<h2 class="anchored" data-anchor-id="multiple-correlation-r">Multiple correlation, R</h2>
<p><span class="math display">\[\large \hat{Y} = b_{0} + b_{1}X_{1} + b_{2}X_{2}\]</span></p>
<ul>
<li><span class="math inline">\(\hat{Y}\)</span> is a linear combination of Xs</li>
<li><span class="math inline">\(r_{Y\hat{Y}}\)</span> = multiple correlation = R</li>
</ul>
<p>–</p>
<p><span class="math display">\[\large R = \sqrt{b_{1}^*r_{Y1} + b_{2}^*r_{Y2}}\]</span> <span class="math display">\[\large R^2 = {b_{1}^*r_{Y1} + b_{2}^*r_{Y2}}\]</span></p>
<hr>
<p><img src="Slide7.jpeg" class="img-fluid"></p>
<hr>
<p><img src="Slide8.jpeg" class="img-fluid"></p>
</section>
<section id="significance-tests" class="level2">
<h2 class="anchored" data-anchor-id="significance-tests">significance tests</h2>
<ul>
<li><span class="math inline">\(R^2\)</span> (omnibus)<br>
</li>
<li>Regression Coefficients<br>
</li>
<li>Increments to <span class="math inline">\(R^2\)</span></li>
</ul>
</section>
<section id="r-squared-r2" class="level2">
<h2 class="anchored" data-anchor-id="r-squared-r2">R-squared, <span class="math inline">\(R^2\)</span></h2>
<ul>
<li><p>Same interpretation as before</p></li>
<li><p>Adding predictors into your model will increase <span class="math inline">\(R^2\)</span> – regardless of whether or not the predictor is significantly correlated with Y.</p></li>
<li><p>Adjusted/Shrunken <span class="math inline">\(R^2\)</span> takes into account the number of predictors in your model</p></li>
</ul>
</section>
<section id="adjusted-r-squared-textadj-r2" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-r-squared-textadj-r2">Adjusted R-squared, <span class="math inline">\(\text{Adj} R^2\)</span></h2>
<p><span class="math display">\[\large R_{A}^2 = 1 - \frac{Var_{res}}{Var_{total}}\]</span></p>
<p><span class="math display">\[\large R_{A}^2 = 1 - \frac{\frac{SS_{res}}{n-p-1}}{\frac{SS_{total}}{n-1}}\]</span> <span class="math display">\[\large R_{A}^2 = 1 - (1 -R^2)\frac{n-1}{n-p-1}\]</span></p>
</section>
<section id="adjusted-r-squared-textadj-r2-1" class="level2">
<h2 class="anchored" data-anchor-id="adjusted-r-squared-textadj-r2-1">Adjusted R-squared, <span class="math inline">\(\text{Adj} R^2\)</span></h2>
<p><span class="math display">\[\large R_{A}^2 = 1 - (1 -R^2)\frac{n-1}{n-p-1}\]</span> - What happens if you add many IV’s to your model that are uncorrelated with your DV?</p>
<ul>
<li>What happens as you add more covariates to your model that are highly correlated with your key predictor, X?</li>
</ul>
<p><span class="math display">\[b_{1}^* = \frac{r_{Y1}-r_{Y2}r_{12}}{1-r_{12}^2}\]</span></p>
</section>
<section id="anova" class="level2">
<h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<div class="cell" data-highlight.output="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support + Anxiety, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1958 -0.8994 -0.1370  0.9990  3.6995 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11</code></pre>
</div>
</div>
</section>
<section id="anova-1" class="level2">
<h2 class="anchored" data-anchor-id="anova-1">ANOVA</h2>
<div class="cell" data-highlight.output="[5,6]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Stress
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Support     1 113.151 113.151  49.028 1.807e-10 ***
Anxiety     1  33.314  33.314  14.435 0.0002336 ***
Residuals 115 265.407   2.308                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="test-of-individual-regression-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="test-of-individual-regression-coefficients">Test of individual regression coefficients</h2>
<p><span class="math display">\[\Large H_{0}: \beta_{X}= 0\]</span> <span class="math display">\[\Large H_{1}: \beta_{X} \neq 0\]</span></p>
</section>
<section id="test-of-individual-regression-coefficients-1" class="level2">
<h2 class="anchored" data-anchor-id="test-of-individual-regression-coefficients-1">Test of individual regression coefficients</h2>
<p>In the case of univariate regression:</p>
<p><span class="math display">\[\Large se_{b} = \frac{s_{Y}}{s_{X}}{\sqrt{\frac {1-r_{xy}^2}{n-2}}}\]</span></p>
<p>In the case of multiple regression:</p>
<p><span class="math display">\[\Large se_{b} = \frac{s_{Y}}{s_{X}}{\sqrt{\frac {1-R_{Y\hat{Y}}^2}{n-p-1}}} \sqrt{\frac {1}{1-R_{i.jkl...p}^2}}\]</span></p>
<ul>
<li>As N increases…</li>
<li>As variance explained increases…</li>
</ul>
</section>
<section id="can-you" class="level2">
<h2 class="anchored" data-anchor-id="can-you">Can you…</h2>
<ul>
<li>write out standardized and unstandardized regression equations?</li>
<li>interpret the coefficients of a multiple regression?</li>
<li>draw comparisons from ANOVA and regression?</li>
<li>calculate <span class="math inline">\(R^2\)</span>?</li>
</ul>
</section>
<section id="warm-up" class="level2">
<h2 class="anchored" data-anchor-id="warm-up">Warm Up</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Age + Poverty, data = nhanes)

Residuals:
   Min     1Q Median     3Q    Max 
-47.54 -19.90   0.82  16.96  65.53 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  58.8926     7.0353   8.371 8.69e-13 ***
Age           0.3537     0.1310   2.699  0.00835 ** 
Poverty      -0.3501     1.5890  -0.220  0.82612    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24.93 on 87 degrees of freedom
  (10 observations deleted due to missingness)
Multiple R-squared:  0.07949,   Adjusted R-squared:  0.05833 
F-statistic: 3.756 on 2 and 87 DF,  p-value: 0.02724</code></pre>
</div>
</div>
<ul>
<li>Interpret all coefficients</li>
<li>Interpret all significance tests of coefficients</li>
<li>Is it a good model?</li>
</ul>
<hr>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>stress.data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"stress.csv"</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(stress.data<span class="sc">$</span>Stress)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   vars   n mean   sd median trimmed  mad  min   max range skew kurtosis   se
X1    1 118 5.18 1.88   5.27    5.17 1.65 0.62 10.32  9.71 0.08     0.22 0.17</code></pre>
</div>
</div>
<div class="cell" data-output.lines="[9,10,11,12,13,14,15,16,17,18,19]">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>mr.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mr.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>...
Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11
...</code></pre>
</div>
</div>
<p>???</p>
</section>
<section id="which-variables-to-include" class="level2">
<h2 class="anchored" data-anchor-id="which-variables-to-include">Which variables to include</h2>
<ul>
<li><p>Your goal should be to match the population model (theoretically)</p></li>
<li><p>Including many variables will not bias parameter estimates but will potentially increase degrees of freedom and standard errors; in other words, putting too many variables in your model may make it <em>more difficult</em> to find a statistically significant result</p></li>
<li><p>But that’s only the case if you add variables unrelated to Y or X; there are some cases in which adding the wrong variables can lead to spurious results. [Stay tuned for the lecture on causal models.]</p></li>
</ul>
</section>
<section id="hierarchical-regression-model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-regression-model-comparison">Hierarchical regression / Model Comparison</h2>
<p><strong>Model comparison:</strong> Comparing how well two (or more) models fit the data in order to determine which model is better.</p>
<p>If we’re comparing nested models by incrementally adding or subtracting variables, this is known as hierarchical regression.</p>
<ul>
<li><p>Multiple models are calculated</p></li>
<li><p>Each predictor (or set of predictors) is assessed in terms of what it adds (in terms of variance explained) at the time it is entered</p></li>
<li><p>Order is dependent on an <em>a priori</em> hypothesis</p></li>
</ul>
<hr>
<p><img src="Slide9.jpeg" class="img-fluid"></p>
</section>
<section id="r-square-change" class="level2">
<h2 class="anchored" data-anchor-id="r-square-change">R-square change</h2>
<ul>
<li><p>distributed as an F <span class="math display">\[F(p.new, N - 1 - p.all) = \frac {R_{m.2}^2- R_{m.1}^2} {1-R_{m.2}^2} (\frac {N-1-p.all}{p.new})\]</span></p></li>
<li><p>can also be written in terms of SSresiduals</p></li>
</ul>
</section>
<section id="model-comparisons-2" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-2">Model comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support, <span class="at">data =</span> stress.data)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>m<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(Stress <span class="sc">~</span> Support <span class="sc">+</span> Anxiety, <span class="at">data =</span> stress.data)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m<span class="fl">.1</span>, m<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Stress ~ Support
Model 2: Stress ~ Support + Anxiety
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    116 298.72                                  
2    115 265.41  1    33.314 14.435 0.0002336 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-comparisons-3" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-3">model comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Stress
           Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Support     1 113.15 113.151  43.939 1.12e-09 ***
Residuals 116 298.72   2.575                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-comparisons-4" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-4">model comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Stress
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Support     1 113.151 113.151  49.028 1.807e-10 ***
Anxiety     1  33.314  33.314  14.435 0.0002336 ***
Residuals 115 265.407   2.308                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-comparisons-5" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-5">model comparisons</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support + Anxiety, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1958 -0.8994 -0.1370  0.9990  3.6995 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.31587    0.85596  -0.369 0.712792    
Support      0.40618    0.05115   7.941 1.49e-12 ***
Anxiety      0.25609    0.06740   3.799 0.000234 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.519 on 115 degrees of freedom
Multiple R-squared:  0.3556,    Adjusted R-squared:  0.3444 
F-statistic: 31.73 on 2 and 115 DF,  p-value: 1.062e-11</code></pre>
</div>
</div>
</section>
<section id="model-comparisons-6" class="level2">
<h2 class="anchored" data-anchor-id="model-comparisons-6">model comparisons</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Stress ~ Support, data = stress.data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.8215 -1.2145 -0.1796  1.0806  3.4326 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.56046    0.42189   6.069 1.66e-08 ***
Support      0.30006    0.04527   6.629 1.12e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.605 on 116 degrees of freedom
Multiple R-squared:  0.2747,    Adjusted R-squared:  0.2685 
F-statistic: 43.94 on 1 and 116 DF,  p-value: 1.12e-09</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>